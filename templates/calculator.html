{% extends "base.html" %}
{% block title %}TimeCost Calculator{% endblock %}

{% block content %}

{% set perspective = session.get("perspective", "river") %}

{% set copy = {
  "river": {
    "title": "What did this cost in work time?",
    "intro": "Enter a price and your pay. I’ll translate it into hours of work.",
    "explain": "This helps you feel the trade between money and time before you spend.",
    "promise": "Result: you’ll see roughly how many work hours it takes to afford this.",
    "hours_line": "This comes to about",
    "thats": "Which is",
    "invalid": "Something here hasn’t settled yet.",
    "live_title": "Live result",
    "err_cost": "I need the item price first.",
    "err_wage": "I need your pay amount to translate this.",
    "err_convert": "These numbers don’t resolve into an hourly rhythm yet."
  },
  "leslie": {
    "title": "What did this cost in work time?",
    "intro": "Let’s turn a price into hours so you can make a powerful, informed decision.",
    "explain": "This helps you decide if something is worth the hours it takes to earn it.",
    "promise": "Result: you’ll see about how many work hours it takes to earn this purchase.",
    "hours_line": "This comes to about",
    "thats": "Which equals",
    "invalid": "Totally fine! One of the inputs just needs a quick fix.",
    "live_title": "Live result",
    "err_cost": "Pop in the item price and we’re golden.",
    "err_wage": "Add your pay amount and we’ll do the time-math.",
    "err_convert": "These numbers need a moment to cooperate. They will."
  },
  "eddie": {
    "title": "What did this cost in work time?",
    "intro": "Tell me the price and your pay. I’ll tell you what it costs in hours of your life.",
    "explain": "This shows you the hours you’re quietly agreeing to give up.",
    "promise": "Result: approximate work hours required to afford this little adventure.",
    "hours_line": "This costs you about",
    "thats": "Which is",
    "invalid": "Darling. No. These numbers are a shambles.",
    "live_title": "Live result",
    "err_cost": "That needs an actual price.",
    "err_wage": "That wage won’t do. Try again, properly.",
    "err_convert": "This conversion is having a nervous breakdown. Adjust accordingly."
  }
} %}

{% set c = copy.get(perspective, copy["river"]) %}

<div class="page">
  <header class="page-header">
    <h1>{{ c.title }}</h1>
    <p class="muted">{{ c.intro }}</p>
    <p class="muted">{{ c.explain }}</p>
  </header>

  <form action="{{ url_for('calculator') }}" method="post" class="stack" id="calcForm">

    <section class="panel">
      <div class="callout">
        <strong>{{ c.promise }}</strong>
      </div>

      <div class="grid-2" style="margin-top:14px;">
        <div class="field">
          <label for="itemName">Item name (optional)</label>
          <input type="text" id="itemName" name="itemName" value="{{ item_name or '' }}">
        </div>

        <div class="field">
          <label for="itemCost">Item cost ({{ currency }})</label>
          <input type="number" step="0.01" inputmode="decimal"
                 id="itemCost" name="itemCost" value="{{ item_cost or '' }}" required>
        </div>
      </div>
    </section>

    <section class="panel">
      <div class="field">
        <label>Salary type</label>

        <div class="radio-group">
          <div class="radio">
            <input id="wt-hourly" type="radio" name="wageType" value="hourly"
              {% if pre_wage_type == "hourly" %}checked{% endif %}>
            <label for="wt-hourly">Hourly</label>
          </div>

          <div class="radio">
            <input id="wt-weekly" type="radio" name="wageType" value="weekly"
              {% if pre_wage_type == "weekly" %}checked{% endif %}>
            <label for="wt-weekly">Weekly</label>
          </div>

          <div class="radio">
            <input id="wt-biweekly" type="radio" name="wageType" value="biweekly"
              {% if pre_wage_type == "biweekly" %}checked{% endif %}>
            <label for="wt-biweekly">Biweekly</label>
          </div>

          <div class="radio">
            <input id="wt-monthly" type="radio" name="wageType" value="monthly"
              {% if pre_wage_type == "monthly" %}checked{% endif %}>
            <label for="wt-monthly">Monthly</label>
          </div>

          <div class="radio">
            <input id="wt-annual" type="radio" name="wageType" value="annual"
              {% if pre_wage_type == "annual" %}checked{% endif %}>
            <label for="wt-annual">Annual</label>
          </div>
        </div>

        <p class="help">This tells us how to translate your pay into an hourly rhythm.</p>
      </div>

      <div class="field">
        <label for="wageAmount">Your wage amount ({{ currency }})</label>
        <input type="number" step="0.01" inputmode="decimal"
               id="wageAmount" name="wageAmount" value="{{ pre_wage_amount or '' }}">
        <p class="help">Leave blank to use your Personal page rate (if set).</p>
      </div>

      <div class="actions">
        <button type="submit" class="btn btn-primary">Calculate</button>
      </div>
    </section>

    {% if result == "Invalid input" %}
      <section class="panel" aria-live="polite">
        <h2 class="card-title">Result</h2>
        <p class="muted">{{ c.invalid }}</p>
      </section>

    {% elif result is not none %}
      <section class="panel" aria-live="polite">
        <h2 class="card-title">Result{% if item_name %} for “{{ item_name }}”{% endif %}</h2>

        <p style="margin:0 0 10px;">
          {{ c.hours_line }} <strong>{{ result|round(2) }}</strong> hours of work.
        </p>

        {% if time_cost and time_cost.ok %}
          <p style="margin:0;">
            {{ c.thats }} <strong>{{ time_cost.human }}</strong>
            {% if workday_text %} <span class="muted">({{ workday_text }})</span>{% endif %}.
          </p>
        {% else %}
          <p class="muted">{{ c.invalid }}</p>
        {% endif %}
      </section>
    {% endif %}

  </form>
</div>

{% endblock %}
