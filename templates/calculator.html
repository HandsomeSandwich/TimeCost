{% extends "base.html" %}
{% block title %}TimeCost Calculator{% endblock %}

{% block content %}

{% set perspective = session.get("perspective", "river") %}

{% set copy = {
  "river": {
    "title": "What did this cost in work time?",
    "intro": "Enter a price and your pay. I’ll translate it into hours of work.",
    "explain": "This helps you feel the trade between money and time before you spend.",
    "promise": "Result: you’ll see roughly how many work hours it takes to afford this.",
    "hours_line": "This comes to about",
    "thats": "Which is",
    "invalid": "Something here hasn’t settled yet.",
    "live_title": "Live result",
    "err_cost": "I need the item price first.",
    "err_wage": "I need your pay amount to translate this.",
    "err_convert": "These numbers don’t resolve into an hourly rhythm yet."
  },
  "leslie": {
    "title": "What did this cost in work time?",
    "intro": "Let’s turn a price into hours so you can make a powerful, informed decision.",
    "explain": "This helps you decide if something is worth the hours it takes to earn it.",
    "promise": "Result: you’ll see about how many work hours it takes to earn this purchase.",
    "hours_line": "This comes to about",
    "thats": "Which equals",
    "invalid": "Totally fine! One of the inputs just needs a quick fix.",
    "live_title": "Live result",
    "err_cost": "Pop in the item price and we’re golden.",
    "err_wage": "Add your pay amount and we’ll do the time-math.",
    "err_convert": "These numbers need a moment to cooperate. They will."
  },
  "eddie": {
    "title": "What did this cost in work time?",
    "intro": "Tell me the price and your pay. I’ll tell you what it costs in hours of your life.",
    "explain": "This shows you the hours you’re quietly agreeing to give up.",
    "promise": "Result: approximate work hours required to afford this little adventure.",
    "hours_line": "This costs you about",
    "thats": "Which is",
    "invalid": "Darling. No. These numbers are a shambles.",
    "live_title": "Live result",
    "err_cost": "That needs an actual price.",
    "err_wage": "That wage won’t do. Try again, properly.",
    "err_convert": "This conversion is having a nervous breakdown. Adjust accordingly."
  }
} %}

{% set c = copy.get(perspective, copy["river"]) %}

<div class="form-container">
  <h1>{{ c.title }}</h1>
  <p class="intro">{{ c.intro }}</p>
  <p class="explain">{{ c.explain }}</p>

  <div class="hint" style="margin: 10px 0 18px 0;">
    <strong>{{ c.promise }}</strong>
  </div>

  <form action="{{ url_for('calculator') }}" method="post" class="calc-form" id="calcForm">
    <div class="field">
      <label for="itemName">Item Name (optional):</label>
      <input type="text" id="itemName" name="itemName" value="{{ item_name or '' }}">
    </div>

    <div class="field">
      <label for="itemCost">Item Cost ({{ currency }}):</label>
      <input
        type="number"
        step="0.01"
        id="itemCost"
        name="itemCost"
        value="{{ item_cost or '' }}"
        required
      >
    </div>

    <fieldset class="radio-group field">
      <legend>Salary Type:</legend>

      <label>
        <input type="radio" name="wageType" value="hourly"
               {% if pre_wage_type == "hourly" %}checked{% endif %}>
        Hourly
      </label>

      <label>
        <input type="radio" name="wageType" value="weekly"
               {% if pre_wage_type == "weekly" %}checked{% endif %}>
        Weekly
      </label>

      <label>
        <input type="radio" name="wageType" value="biweekly"
               {% if pre_wage_type == "biweekly" %}checked{% endif %}>
        Biweekly
      </label>

      <label>
        <input type="radio" name="wageType" value="monthly"
               {% if pre_wage_type == "monthly" %}checked{% endif %}>
        Monthly
      </label>

      <label>
        <input type="radio" name="wageType" value="annual"
               {% if pre_wage_type == "annual" %}checked{% endif %}>
        Annual
      </label>
    </fieldset>

    <div class="field">
      <label for="wageAmount">Your Wage Amount ({{ currency }}):</label>
      <input
        type="number"
        step="0.01"
        id="wageAmount"
        name="wageAmount"
        value="{{ pre_wage_amount or '' }}"
      >
      <small class="hint">Leave blank to use your Personal page rate.</small>
    </div>

    <button type="submit">Calculate Time Cost</button>
  </form>

  {% if result == "Invalid input" %}
    <div class="result-card" role="status">
      <h2>Result</h2>
      <p class="error-text">{{ c.invalid }}</p>
    </div>

  {% elif result is not none %}
    <div class="result-card" role="status">
      <h2>Result{% if item_name %} for “{{ item_name }}”{% endif %}</h2>

      <p>
        {{ c.hours_line }} <strong>{{ result|round(2) }}</strong> hours of work.
      </p>

      {% if time_cost and time_cost.ok %}
        <p>
          {{ c.thats }} <strong>{{ time_cost.human }}</strong>
          {% if workday_text %} ({{ workday_text }}){% endif %}.
        </p>
      {% else %}
        <p class="error-text">{{ c.invalid }}</p>
      {% endif %}
    </div>
  {% endif %}
</div>

{% endblock %}
