<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}TimeCost{% endblock %}</title>

  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

  {% block head %}{% endblock %}
</head>

<body>
  <header>
    <h1>TimeCost</h1>
  </header>

  <nav class="navbar">
  <button class="nav-toggle" aria-label="Open menu" aria-controls="mobile-drawer" aria-expanded="false">
    ☰
  </button>

  <div class="nav-links">
    <a href="{{ url_for('calculator') }}">Calculator</a>
    <a href="{{ url_for('personal') }}">Personal</a>
    <a href="{{ url_for('expenses') }}">Expenses</a>
    <a href="{{ url_for('timebank') }}">Time Bank</a>
    <a href="{{ url_for('budget') }}">Budget</a>
    <a href="{{ url_for('goals') }}">Goals</a>
    <a href="{{ url_for('staples') }}">Staples</a>
  </div>

    <div class="nav-right">
    <form action="{{ url_for('set_currency') }}" method="post" class="currency-form">
      <select name="currency" aria-label="Currency">
        {% set cur = session.get("currency", "$") %}
        <option value="$" {{ "selected" if cur == "$" else "" }}>$ (USD)</option>
        <option value="£" {{ "selected" if cur == "£" else "" }}>£ (GBP)</option>
        <option value="€" {{ "selected" if cur == "€" else "" }}>€ (EUR)</option>
        <option value="¥" {{ "selected" if cur == "¥" else "" }}>¥ (JPY)</option>
        <option value="₹" {{ "selected" if cur == "₹" else "" }}>₹ (INR)</option>
      </select>
      <button type="submit">Set</button>
    </form>

    {% block nav_right %}{% endblock %}
  </div>

</nav>

<div id="drawer-backdrop" class="drawer-backdrop" hidden></div>

<aside id="mobile-drawer" class="drawer" hidden>
  <div class="drawer-header">
    <strong>Menu</strong>
    <button class="drawer-close" aria-label="Close menu">✕</button>
  </div>

  <a href="{{ url_for('calculator') }}">Calculator</a>
  <a href="{{ url_for('personal') }}">Personal</a>
  <a href="{{ url_for('expenses') }}">Expenses</a>
  <a href="{{ url_for('timebank') }}">Time Bank</a>
  <a href="{{ url_for('budget') }}">Budget</a>
  <a href="{{ url_for('goals') }}">Goals</a>
  <a href="{{ url_for('staples') }}">Staples</a>

  <form action="{{ url_for('set_currency') }}" method="post" class="currency-form drawer-currency">
  <select name="currency" aria-label="Currency">
    {% set cur = session.get("currency", "$") %}
    <option value="$" {{ "selected" if cur == "$" else "" }}>$ (USD)</option>
    <option value="£" {{ "selected" if cur == "£" else "" }}>£ (GBP)</option>
    <option value="€" {{ "selected" if cur == "€" else "" }}>€ (EUR)</option>
    <option value="¥" {{ "selected" if cur == "¥" else "" }}>¥ (JPY)</option>
    <option value="₹" {{ "selected" if cur == "₹" else "" }}>₹ (INR)</option>
  </select>
  <button type="submit">Set</button>
</form>

</aside>

<script>
  (function () {
    const toggle = document.querySelector(".nav-toggle");
    const drawer = document.getElementById("mobile-drawer");
    const backdrop = document.getElementById("drawer-backdrop");
    const closeBtn = document.querySelector(".drawer-close");

    function openDrawer() {
      drawer.hidden = false;
      backdrop.hidden = false;
      toggle.setAttribute("aria-expanded", "true");
      document.body.classList.add("drawer-open");
    }

    function closeDrawer() {
      drawer.hidden = true;
      backdrop.hidden = true;
      toggle.setAttribute("aria-expanded", "false");
      document.body.classList.remove("drawer-open");
    }

    toggle?.addEventListener("click", () => {
      const isOpen = toggle.getAttribute("aria-expanded") === "true";
      isOpen ? closeDrawer() : openDrawer();
    });

    closeBtn?.addEventListener("click", closeDrawer);
    backdrop?.addEventListener("click", closeDrawer);
    drawer?.querySelectorAll("a").forEach(a => a.addEventListener("click", closeDrawer));

    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") closeDrawer();
    });
  })();
</script>


  <main class="container">
    {% block content %}{% endblock %}
  </main>

  <footer>
    <p>&copy; TimeCost</p>
  </footer>
</body>
</html>
